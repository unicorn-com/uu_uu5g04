<!DOCTYPE html>
<html>
  <head>
    <meta
      charset="utf-8"
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=2,minimum-scale=0.5"
    />
    <title>UserPreferencesContext Demo</title>

    <script src="https://cdn.plus4u.net/uu-uu5loaderg01/1.0.0/uu5loaderg01.min.js" crossorigin="anonymous"></script>
    <script>
      Uu5Loader.config({
        imports: {
          systemjs: "https://cdn.plus4u.net/libs/systemjs/0.19.47/system.js",
          react: "https://cdn.plus4u.net/libs/react/16.8.6/react.min.js",
          "react-dom": "https://cdn.plus4u.net/libs/react-dom/16.14.0/react-dom.min.js",
          "prop-types": "https://cdn.plus4u.net/libs/prop-types/15.7.2/prop-types.min.js",
          "create-react-class": "https://cdn.plus4u.net/libs/create-react-class/15.6.3/create-react-class.min.js",

          uu5g04: "https://cdn.plus4u.net/uu-uu5g04/1.0.0/uu5g04.min.js",
          "uu5g04-bricks": "https://cdn.plus4u.net/uu-uu5g04/1.0.0/uu5g04-bricks.min.js",
          "uu5g04-forms": "https://cdn.plus4u.net/uu-uu5g04/1.0.0/uu5g04-forms.min.js",
        },
      });
    </script>
  </head>
  <body>
    <div id="renderHere">Loading...</div>

    <script type="text/babel">
      import UU5, { createVisualComponent } from "uu5g04";
      import "uu5g04-bricks";
      import "uu5g04-forms";

      //@@viewOn:example
      export const withUserPreferences = (Component) => {
        if (!UU5.Common.Context.isSupported()) return Component;
        let forwardRef = UU5.Common.Reference.forward((props, ref) => {
          return (
            <UU5.Common.UserPreferencesContext.Consumer>
              {(context) => <Component {...props} {...context} ref={ref} />}
            </UU5.Common.UserPreferencesContext.Consumer>
          );
        });

        forwardRef.isUu5PureComponent = true;
        forwardRef.displayName = `forwardRef(${Component.displayName || Component.name || "Component"})`;
        forwardRef.tagName = Component.tagName;

        return forwardRef;
      };
      //@@viewOff:example

      //@@viewOn:example
      const ValueTable = withUserPreferences(
        createVisualComponent({
          render() {
            const {
              region,
              timeZone,
              shortDateFormat,
              mediumDateFormat,
              longDateFormat,
              weekStartDay,
              hourFormat,
              languageList,
              numberGroupingSeparator,
              numberDecimalSeparator,
              currency,
              currencyGroupingSeparator,
              currencyDecimalSeparator,
            } = this.props;

            return (
              <UU5.Bricks.Table className={UU5.Common.Css.css`margin: 16px 0 0;`}>
                <UU5.Bricks.Table.TBody>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>region</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{region}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>timeZone</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{timeZone}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>shortDateFormat</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{shortDateFormat}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>mediumDateFormat</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{mediumDateFormat}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>longDateFormat</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{longDateFormat}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>weekStartDay</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{weekStartDay}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>hourFormat</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{hourFormat}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>languageList</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{languageList ? languageList.join(", ") : null}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>numberGroupingSeparator</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{numberGroupingSeparator}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>numberDecimalSeparator</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{numberDecimalSeparator}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>currency</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{currency}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>currencyGroupingSeparator</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{currencyGroupingSeparator}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                  <UU5.Bricks.Table.Tr>
                    <UU5.Bricks.Table.Td>currencyDecimalSeparator</UU5.Bricks.Table.Td>
                    <UU5.Bricks.Table.Td>{currencyDecimalSeparator}</UU5.Bricks.Table.Td>
                  </UU5.Bricks.Table.Tr>
                </UU5.Bricks.Table.TBody>
              </UU5.Bricks.Table>
            );
          },
        })
      );
      //@@viewOff:example

      let contextValues = {
        region: "London",
        timeZone: "UTC",
        weekStartDay: 7,
        shortDateFormat: "D. YY",
        mediumDateFormat: "M. D. Y",
        longDateFormat: "MM. DD. Y",
        hourFormat: 12,
        numberGroupingSeparator: "/",
        numberDecimalSeparator: "-",
        languageList: ["en-us", "en-gb", "cs-cz"],
        numberGroupingSeparator: ".",
        numberDecimalSeparator: ",",
        currency: "GBP",
        currencyGroupingSeparator: ".",
        currencyDecimalSeparator: ",",
      };

      //@@viewOn:example
      const Demo = createVisualComponent({
        getInitialState() {
          return {
            propsSource: "defaultContextValue",
          };
        },

        render() {
          return (
            <UU5.Bricks.Container header="UserPreferencesContext">
              <UU5.Common.UserPreferencesProvider
                {...(this.state.propsSource === "customContextValue" ? contextValues : {})}
              >
                <UU5.Bricks.Row>
                  <UU5.Bricks.Column colWidth="s-12 m-6">
                    <UU5.Bricks.Row level="6" header="Calendar">
                      <UU5.Bricks.Calendar />
                    </UU5.Bricks.Row>
                    <UU5.Bricks.Row level="6" header="DateTime">
                      <UU5.Bricks.DateTime />
                    </UU5.Bricks.Row>
                    <UU5.Bricks.Row level="6" header="Number">
                      <UU5.Bricks.Number value={1000.1} />
                    </UU5.Bricks.Row>
                    <UU5.Bricks.Row level="6" header="DateTimePicker">
                      <UU5.Forms.DateTimePicker value={new Date()} />
                    </UU5.Bricks.Row>
                    <UU5.Bricks.Row level="6" header="DateTimeRangePicker">
                      <UU5.Forms.DateTimeRangePicker value={[new Date(), new Date()]} />
                    </UU5.Bricks.Row>
                    <UU5.Bricks.Row level="6" header="Number">
                      <UU5.Forms.Number value={1000.1} />
                    </UU5.Bricks.Row>
                    <UU5.Bricks.Row level="6" header="TimePicker">
                      <UU5.Forms.TimePicker value="10:00" />
                    </UU5.Bricks.Row>
                  </UU5.Bricks.Column>
                  <UU5.Bricks.Column colWidth="s-12 m-6">
                    <UU5.Forms.Form>
                      <UU5.Forms.SwitchSelector
                        items={[
                          { value: "customContextValue", content: "customContextValue" },
                          { value: "defaultContextValue", content: "defaultContextValue" },
                        ]}
                        value={this.state.propsSource}
                        label="Props Source"
                        onChange={({ value }) => this.setState({ propsSource: value })}
                        labelColWidth="xs-12"
                        inputColWidth="xs-12"
                      />
                    </UU5.Forms.Form>
                    <ValueTable />
                  </UU5.Bricks.Column>
                </UU5.Bricks.Row>
              </UU5.Common.UserPreferencesProvider>
            </UU5.Bricks.Container>
          );
        },
      });
      //@@viewOff:example

      UU5.Common.DOM.render(<Demo />, document.getElementById("renderHere"));
    </script>
  </body>
</html>
